<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${post.title}">Post Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">


    <style>
        body {
            background-color: #f6f6f6;
            font-family: "Noto Sans", "Open Sans", "Roboto", sans-serif;
            color: #222;
            line-height: 1.8;
        }

        .post-container {
        max-width: 1050px;
        margin: 3rem auto;
        background: #fffdfa; /* trắng ngà nhẹ, giúp dịu mắt */
        border-radius: 10px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.08); /* bóng mềm tự nhiên */
        padding: 3rem 4rem;
        border: 1px solid #f0e6d2; /* viền mờ, tạo khung rõ hơn */
    }

        .post-title {
            font-size: 2.3rem;
            font-weight: 700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
        }

        .post-meta {
            text-align: center;
            color: #777;
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }

        .post-image {
            display: block;
            margin: 0 auto 2rem auto;
            border-radius: 4px;
            width: 100%;
            height: auto;
            max-height: 550px;
            object-fit: cover;
        }

        .post-content {
            white-space: pre-line;
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 2rem;
        }

        .post-content p {
            margin-bottom: 1.4rem;
            text-align: justify;
        }

        .post-content::first-letter {
            font-size: 2.4rem;
            font-weight: bold;
            color: #111;
            margin-right: 5px;
            float: left;
            line-height: 1;
        }

        /* Video */
        .video-container {
            margin: 2rem 0;
            display: flex;
            justify-content: center;
        }

        iframe, video {
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            height: 450px;
        }

        /* Comment section */
        hr {
            margin: 2.5rem 0;
        }

        .comment-card {
            border: 1px solid #ddd;
            background-color: #fafafa;
        }

        .comment-form textarea {
            resize: none;
        }

        .btn-primary {
            background-color: #000;
            border: none;
            transition: background-color 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #444;
        }

        .btn-secondary {
            background-color: #555;
            border: none;
        }

        .btn-secondary:hover {
            background-color: #222;
        }

        /* Responsive cho mobile */
        @media (max-width: 768px) {
            .post-container {
                padding: 2rem 1.5rem;
            }
        }
    </style>

</head>

<body>
<!-- Navbar -->
<div th:replace="fragments/navbar :: body"></div>

<div class="post-container">
    <!-- Tiêu đề -->
    <h1 th:text="${post.title}" class="post-title"></h1>
    <p class="post-meta">
        <i class="bi bi-calendar3"></i>
        <span th:text="${#temporals.format(post.createdAt, 'dd/MM/yyyy HH:mm')}"></span>
    </p>

    <!-- Ảnh chính -->
    <div th:if="${post.imageUrl}">
        <img th:src="${post.imageUrl}" class="post-image" alt="Post Image">
    </div>

    <!-- Nội dung bài viết -->
    <div class="post-content"
         th:utext="${#strings.replace(post.content, '\n', '<br/>')}"></div>

    <!-- Video (YouTube hoặc upload) -->
    <div class="video-container" th:if="${post.videoUrl != null}">
        <iframe th:src="@{${post.videoUrl}}" width="720" height="405" frameborder="0" allowfullscreen></iframe>
    </div>

    <div class="video-container" th:if="${post.videoFile != null}">
        <video width="720" height="405" controls>
            <source th:src="@{${post.videoFile}}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <hr>

    <!-- Bình luận -->
    <h4 class="mb-3">Comments</h4>

    <!-- Form thêm comment -->
    <form th:action="@{/comments/save/{postId}(postId=${post.id})}" method="post"
          th:object="${comment}" class="comment-form mb-4">
        <div class="mb-3">
            <textarea th:field="*{content}" class="form-control" rows="3"
                      placeholder="Write a comment..." required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Add Comment</button>
    </form>

    <!-- Danh sách comment -->
    <div th:each="c : ${comments}">
        <div class="card comment-card mb-2 p-2">
            <div class="card-body">
                <p th:text="${c.content}"></p>
                <div class="d-flex justify-content-between align-items-center">
                    <small class="comment-date" th:text="${#temporals.format(c.createdAt, 'dd/MM/yyyy HH:mm')}"></small>
                    <a th:href="@{/comments/delete/{id}/{postId}(id=${c.id}, postId=${post.id})}"
                       class="btn btn-outline-danger btn-sm">Delete</a>
                </div>
            </div>
        </div>
    </div>

    <a href="/" class="btn btn-secondary mt-4">Back to Home</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.js"></script>
</body>
</html>
